// Taildown Interactive Components
// Generated by Taildown compiler
// Total size: ~0.78KB

(function() {
  'use strict';

  console.log('[Taildown] JavaScript loaded');

  // Initialize all components when DOM is ready
  if (document.readyState === 'loading') {
    console.log('[Taildown] Waiting for DOMContentLoaded');
    document.addEventListener('DOMContentLoaded', init);
  } else {
    console.log('[Taildown] DOM already ready, initializing now');
    init();
  }

  function init() {
    console.log('[Taildown] Initializing interactive components');
    // Tooltip Component
    getComponents('tooltip').forEach(wrapper => {
      const trigger = wrapper.querySelector('[data-tooltip-trigger]');
      const tooltip = wrapper.querySelector('[data-tooltip-content]');
      
      if (!trigger || !tooltip) return;
      
      let isVisible = false;
      let hideTimeout = null;
      
      // Show tooltip
      function show() {
        if (isVisible) return;
        
        clearTimeout(hideTimeout);
        isVisible = true;
        tooltip.hidden = false;
        tooltip.style.display = 'block';
        
        // Fade in
        requestAnimationFrame(() => {
          tooltip.style.opacity = '1';
        });
        
        const tooltipId = 'tooltip-' + Math.random().toString(36).substr(2, 9);
        tooltip.id = tooltipId;
        trigger.setAttribute('aria-describedby', tooltipId);
      }
      
      // Hide tooltip
      function hide() {
        clearTimeout(hideTimeout);
        hideTimeout = setTimeout(() => {
          isVisible = false;
          tooltip.style.opacity = '0';
          
          setTimeout(() => {
            tooltip.hidden = true;
            tooltip.style.display = 'none';
          }, 200);
          
          trigger.removeAttribute('aria-describedby');
        }, 100);
      }
      
      // Mouse events
      trigger.addEventListener('mouseenter', show);
      trigger.addEventListener('mouseleave', hide);
      
      // Focus events
      trigger.addEventListener('focus', show);
      trigger.addEventListener('blur', hide);
      
      // Touch support for mobile
      trigger.addEventListener('click', (e) => {
        e.preventDefault();
        if (isVisible) {
          hide();
        } else {
          show();
        }
      });
      
      // Initialize as hidden
      tooltip.hidden = true;
      tooltip.style.display = 'none';
      tooltip.style.opacity = '0';
    });
    console.log('[Taildown] Initialization complete');
  }

  // Utility: Get all elements with data-component attribute
  function getComponents(name) {
    return document.querySelectorAll(`[data-component="${name}"]`);
  }

  // Utility: Toggle class on element
  function toggleClass(el, className, force) {
    el.classList.toggle(className, force);
  }

  // Utility: Set multiple attributes
  function setAttrs(el, attrs) {
    for (const [key, value] of Object.entries(attrs)) {
      el.setAttribute(key, value);
    }
  }
})();
